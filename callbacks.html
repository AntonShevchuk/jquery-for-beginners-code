<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Пример использования с $.Callbacks</title>
    <link rel="profile" href="https://gmpg.org/xfn/11"/>
    <link rel="shortcut icon" href="https://anton.shevchuk.name/favicon.ico"/>
    <link rel="stylesheet" href="css/styles.css"/>
    <style>
        article {
            overflow: visible;
            min-height: 120px;
            margin: 10px;
            position: relative;
        }

        #car {
            width: 100px;
            height: 100px;
            position: absolute;
            background: url(images/car.png) 50% 50% no-repeat;
            r
            transition: all 0.2s ease-in-out;
        }

        .up {
            transform: rotate(0deg);
        }

        .down {
            transform: rotate(180deg);
        }

        .right {
            transform: rotate(90deg);
        }

        .left {
            transform: rotate(270deg);
        }
    </style>
    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/code.js"></script>
    <script>
      var C = $.Callbacks()
      var car

      $(function () {
        car = $('#car')
        C.add(function (speed) {
          output('\nSpeed 200px per ' + speed + ' ms: ')
        })

        $(document).keydown(function (e) {
          // 37 - left
          // 38 - up
          // 39 - right
          // 40 - down
          switch (e.keyCode) {
            case 37:
              C.add(function (speed) {
                car.queue(function () {
                  $(this).attr('class', 'left')
                    .dequeue()
                })
                car.animate({ left: '-=200' }, speed)
                output('&larr; ')
              })
              output('\nAdded &larr;')
              break
            case 38:
              C.add(function (speed) {
                car.queue(function () {
                  $(this).attr('class', 'up')
                    .dequeue()
                }).animate({ top: '-=200' }, speed)
                output('&uarr; ')
              })
              output('\nAdded &uarr;')
              break
            case 39:
              C.add(function (speed) {
                car.queue(function () {
                  $(this).attr('class', 'right')
                    .dequeue()
                })
                car.animate({ left: '+=200' }, speed)
                output('&rarr; ')
              })
              output('\nAdded &rarr;')
              break
            case 40:
              C.add(function (speed) {
                car.queue(function () {
                  $(this).attr('class', 'down')
                    .dequeue()
                })
                car.animate({ top: '+=200' }, speed)
                output('&darr; ')
              })
              output('\nAdded &darr;')
              break
          }
        })
      })
    </script>
</head>
<body>
<main id="content">
    <header>
        <h1>Пример работы $.Callbacks</h1>
        <p>На практике мне ещё не приходилось использовать, поэтому пример немного надуманный - запрограммируйте
            поездку машинки используя стрелки на клавиатуре, а затем запустите программу, указав скорость анимации.
        </p>
        <p>Чем меньше цифра, тем быстрее будет перемещаться машинка.</p>
    </header>
    <article>
        <div id="car"></div>
    </article>
    <footer>
        &copy; Anton Shevchuk &mdash; <a href="https://anton.shevchuk.name/jquery-book/">jQuery Book</a>
    </footer>
</main>
<aside>
    <nav>
        <a href="deferred.pipe.html" title="go prev" class="button" rel="prev">&larr; Back</a>
        <a href="index.html" title="back to Index" class="button" rel="index">Index &sect;</a>
        <a href="#" title="reload" class="button" onclick="window.location.reload();return false">Reload &curren;</a>
    </nav>
    <hr/>
    <pre><code><em>// use button up arrow: &uarr;</em>
C.add(function(speed){
    car.animate({top:'-=200px'}, speed)
})</code></pre>
    <pre><code><em>// use button down arrow: &darr;</em>
C.add(function(speed){
    car.animate({top:'+=200px'}, speed)
})</code></pre>
    <pre><code><em>// use button right arrow: &rarr;</em>
C.add(function(speed){
    car.animate({left:'+=200px'}, speed)
})</code></pre>
    <pre><code><em>// use button left arrow: &larr;</em>
C.add(function(speed){
    car.animate({left:'-=200px'}, speed)
})</code></pre>
    <pre><code contenteditable="true">C.fire(200)</code></pre>
    <button type="button" class="code">Run Code</button>
</aside>
<aside id="output">
    <h3>Output</h3>
    <pre></pre>
</aside>
</body>
</html>
